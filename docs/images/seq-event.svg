<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="543px" preserveAspectRatio="none" style="width:385px;height:543px;" version="1.1" viewBox="0 0 385 543" width="385px" zoomAndPan="magnify"><defs><filter height="300%" id="f1scbzsinbsg1j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1scbzsinbsg1j)" height="170.4688" style="stroke: #000000; stroke-width: 2.0;" width="324" x="13" y="55.2969"/><rect fill="#FFFFFF" filter="url(#f1scbzsinbsg1j)" height="238.7344" style="stroke: #000000; stroke-width: 2.0;" width="353" x="13" y="239.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="38.2969" y2="101.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="101.5625" y2="142.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="142.3672" y2="369.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="68" x2="68" y1="369.4297" y2="410.2344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="68" y1="410.2344" y2="495.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275.5" x2="275.5" y1="38.2969" y2="101.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="275.5" x2="275.5" y1="101.5625" y2="142.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275.5" x2="275.5" y1="142.3672" y2="369.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="275.5" x2="275.5" y1="369.4297" y2="410.2344"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="275.5" x2="275.5" y1="410.2344" y2="495.5"/><rect fill="#FEFECE" filter="url(#f1scbzsinbsg1j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="23" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="30" y="22.9951">Consumer</text><rect fill="#FEFECE" filter="url(#f1scbzsinbsg1j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="23" y="494.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="30" y="514.4951">Consumer</text><rect fill="#FEFECE" filter="url(#f1scbzsinbsg1j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="247.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="254.5" y="22.9951">Thing</text><rect fill="#FEFECE" filter="url(#f1scbzsinbsg1j)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="53" x="247.5" y="494.5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="39" x="254.5" y="514.4951">Thing</text><path d="M13,55.2969 L245,55.2969 L245,62.2969 L235,72.2969 L13,72.2969 L13,55.2969 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="170.4688" style="stroke: #000000; stroke-width: 2.0;" width="324" x="13" y="55.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="187" x="28" y="68.3638">Event (HTTP long polling)</text><polygon fill="#A80036" points="264,89.5625,274,93.5625,264,97.5625,268,93.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="270" y1="93.5625" y2="93.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="75" y="88.4966">GET /lpalert HTTP/1.1</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="84" y="125.7729">イベントが発生するまで返答を保留</text><path d="M224,147.3672 L224,172.3672 L323,172.3672 L323,157.3672 L313,147.3672 L224,147.3672 " fill="#FBFB77" filter="url(#f1scbzsinbsg1j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M313,147.3672 L313,157.3672 L323,157.3672 L313,147.3672 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="230" y="164.4341">イベント発生</text><polygon fill="#A80036" points="79,213.7656,69,217.7656,79,221.7656,75,217.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="275" y1="217.7656" y2="217.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="85" y="197.5669">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="89" y="212.6997">payload:{"alert":"overheat"}</text><path d="M13,239.7656 L199,239.7656 L199,246.7656 L189,256.7656 L13,256.7656 L13,239.7656 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="238.7344" style="stroke: #000000; stroke-width: 2.0;" width="353" x="13" y="239.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="141" x="28" y="252.8325">Event (WebSocket)</text><polygon fill="#A80036" points="264,289.1641,274,293.1641,264,297.1641,268,293.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="270" y1="293.1641" y2="293.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="75" y="272.9653">GET /wsalert HTTP/1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="75" y="288.0981">Upgrade: websocket</text><polygon fill="#A80036" points="79,318.2969,69,322.2969,79,326.2969,75,322.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="275" y1="322.2969" y2="322.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="85" y="317.231">101 Switching Protocols</text><path d="M195,335.2969 L195,360.2969 L352,360.2969 L352,345.2969 L342,335.2969 L195,335.2969 " fill="#FBFB77" filter="url(#f1scbzsinbsg1j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M342,335.2969 L342,345.2969 L352,345.2969 L342,335.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="201" y="352.3638">WebSocketに切り替え</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="174" y="393.6401"/><path d="M224,415.2344 L224,440.2344 L323,440.2344 L323,425.2344 L313,415.2344 L224,415.2344 " fill="#FBFB77" filter="url(#f1scbzsinbsg1j)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M313,415.2344 L313,425.2344 L323,425.2344 L313,415.2344 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="230" y="432.3013">イベント発生</text><polygon fill="#A80036" points="79,466.5,69,470.5,79,474.5,75,470.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73" x2="275" y1="470.5" y2="470.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="85" y="465.4341">{"alert":"overheat"}</text><!--MD5=[c8210c5087ee752b2f5b68aedfa9827a]
@startuml
group Event (HTTP long polling)
Consumer -> Thing: GET /lpalert HTTP/1.1
... イベントが発生するまで返答を保留 ...
note over Thing: イベント発生
Consumer <- Thing: 200 OK\n payload:{"alert":"overheat"}
end
group Event (WebSocket)
Consumer -> Thing: GET /wsalert HTTP/1.1\nUpgrade: websocket
Consumer <- Thing: 101 Switching Protocols
note over Thing: WebSocketに切り替え
... ...
note over Thing: イベント発生
Consumer <- Thing: {"alert":"overheat"}
end
@enduml

PlantUML version 1.2020.16(Sun Aug 23 20:20:43 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>